<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Supported Emoji</title>
<style>
body { 
	margin: 3rem; 
	background: #eee;
}
header {
	display: flex;
	justify-content: space-between;
}
h1 {
	margin: 0;
}
#version {
	text-align: right;
}
table {
	border-collapse: collapse;
	width: 100%;
	text-align: left;
}
tbody {
	font-size: 150%; 
}
tr:nth-child(even) {
	background: #fff;
}
td {
	border: 1px solid #ccc;
	padding: 0 10px;
}
.index {
	text-align: center;
}
.form {
	text-align: center;
}
td.form {
	font-size: 200%;
}
.form a {
	text-decoration: none;
}
.hex {
	width: 100%;
}
td.index {
	color: #999;
}
td.hex {
	font: 11pt monospace;	
}
</style>
</head>
<body>
<header>
<h1>Supported Emoji</h1>
<span id="version">
<a href="https://github.com/adraffy/ens-normalize.js">@adraffy/ens-normalize.js</a><br>
<a href="https://github.com/adraffy/ensip-norm">@adraffy/ensip-norm</a>
</span>
</header>
<ul id="toc"></ul>
<div id="sections"></div>
<script type="module">
import {
	ens_normalize, ens_beautify, ens_tokenize, ens_emoji,
	hex_cp, explode_cp, compare_arrays,
	dom_from_tokens, use_default_style
} from '../dist/all.min.js';
use_default_style();

let buckets = [];
for (let cps of ens_emoji().sort(compare_arrays)) {
	let name = String.fromCodePoint(...cps);
	let norm = ens_normalize(name);
	let pretty = ens_beautify(norm);
	let n = [...norm].length;
	let bucket = buckets[n];
	if (!bucket) buckets[n] = bucket = [];
	bucket.push({name, norm, pretty, cps});
}

document.querySelector('h1').innerHTML += ` (${buckets.reduce((a, x) => a + (x?x.length:0), 0)})`;

for (let n = 0; n < buckets.length; n++) {
	let bucket = buckets[n];
	if (!bucket) continue;
	let title = `${n} character${n==1?'':'s'} (${bucket.length})`;

	let li = document.createElement('li');
	li.innerHTML = `<a href="#${n}">${title}</a>`;
	document.querySelector('#toc').append(li);

	let section = document.createElement('section');
	section.innerHTML = `
		<h2><a name="${n}">${title}</a></h2>
		<table>
		<thead>
		<tr>
		<th class="index"></th>
		<th class="form">Form</th>
		<th class="exploded">Parts</th>
		<th class="hex">Fully Qualified</th>
		</tr>
		</thead>
		<tbody></tbody>
		</table>
	`;
	//<th class="form">Norm</th>
	//<th class="form">Beautify</th>
	section.querySelector('tbody').append(...bucket.map(({cps, name, norm pretty}, i) => {
		let tr = document.createElement('tr');
		tr.innerHTML = `
			<td class="index">${i+1}</td>
			<td class="form"><a href="resolver.html#${encodeURIComponent(name)}.eth" target="_blank">${name}</a></td>
			<td class="exploded"></td>
			<td class="hex">${cps.map(hex_cp).join(' ')}</td>
		`;
		//<td class="form">${name!==norm?norm:''}</a></td>
		//<td class="form">${norm!==pretty?pretty:''}</a></td>
		tr.querySelector('.exploded').append(dom_from_tokens(ens_tokenize(name)));
		return tr;
	}));

	document.body.append(section);
}
</script>
</body>
</html>